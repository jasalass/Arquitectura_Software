{
 "settings": {
  "env": {
   "BASE_URL": "http://api.utf.local"
  },
  "http": {
   "timeout": "30s"
  }
 },
 "execution": [
  {
   "concurrency": 100,
   "ramp-up": "30s",
   "hold-for": "2m",
   "scenario": "flujo-completo-toma-ramos"
  },
  {
   "concurrency": 300,
   "ramp-up": "45s",
   "hold-for": "3m",
   "scenario": "flujo-completo-toma-ramos"
  },
  {
   "concurrency": 500,
   "ramp-up": "1m",
   "hold-for": "3m",
   "scenario": "flujo-completo-toma-ramos"
  },
  {
   "concurrency": 1000,
   "ramp-up": "90s",
   "hold-for": "3m",
   "scenario": "flujo-completo-toma-ramos"
  },
  {
   "concurrency": 3000,
   "ramp-up": "2m",
   "hold-for": "3m",
   "scenario": "flujo-completo-toma-ramos"
  },
  {
   "concurrency": 5000,
   "ramp-up": "3m",
   "hold-for": "3m",
   "scenario": "flujo-completo-toma-ramos"
  },
  {
   "concurrency": 10000,
   "ramp-up": "4m",
   "hold-for": "3m",
   "scenario": "flujo-completo-toma-ramos"
  }
 ],
 "scenarios": {
  "flujo-completo-toma-ramos": {
   "think-time": "0.3s",
   "requests": [
    {
     "label": "login-email",
     "url": "${BASE_URL}/auth",
     "method": "POST",
     "headers": {
      "Content-Type": "application/json"
     },
     "body": "{\n  \"email\": \"user@email.com\",\n  \"password\": \"12345\"\n}\n",
     "extract-jsonpath": {
      "token": {
       "jsonpath": "$.token"
      },
      "user_uuid": {
       "jsonpath": "$.user.uuid"
      }
     }
    },
    {
     "label": "ver-asignaturas",
     "url": "${BASE_URL}/inscripcion/asignaturas",
     "method": "GET",
     "headers": {
      "Authorization": "Bearer ${token}"
     },
     "extract-jsonpath": {
      "seccion_id": {
       "jsonpath": "$[0].secciones[0].id",
       "default": 4
      }
     }
    },
    {
     "label": "tomar-ramo",
     "url": "${BASE_URL}/inscripcion/inscripciones",
     "method": "POST",
     "headers": {
      "Content-Type": "application/json",
      "Authorization": "Bearer ${token}"
     },
     "body": "{\n  \"alumnoRef\": \"${user_uuid}\",\n  \"seccionId\": ${seccion_id}\n}\n"
    },
    {
     "label": "ver-inscripciones-alumno",
     "url": "${BASE_URL}/inscripcion/alumnos/${user_uuid}/asignaturas",
     "method": "GET",
     "headers": {
      "Authorization": "Bearer ${token}"
     }
    },
    {
     "label": "estado-alumno-inscripcion",
     "url": "${BASE_URL}/inscripcion/alumno-estado/${user_uuid}",
     "method": "GET",
     "headers": {
      "Authorization": "Bearer ${token}"
     }
    },
    {
     "label": "estado-pago",
     "url": "${BASE_URL}/pago/estado/${user_uuid}",
     "method": "GET",
     "headers": {
      "Authorization": "Bearer ${token}"
     }
    },
    {
     "label": "pagar-matricula",
     "url": "${BASE_URL}/pago/pagar-matricula",
     "method": "POST",
     "headers": {
      "Content-Type": "application/json",
      "Authorization": "Bearer ${token}"
     },
     "body": "{\n  \"uuid\": \"${user_uuid}\"\n}\n"
    }
   ]
  }
 }
}
